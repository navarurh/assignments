install.packages("car",dep=T)
library(car)
linear.hypothesis(model1,c("LSAT=0,GPA=0"))
linearHypothesis(model1,c("LSAT=0,GPA=0"))
#home directory definition
setwd("/home/navarurh/documents/assignments/businessanalytics-R/assgn-2/")
#packages used for the assignment
library(data.table)
library(DBI)
library(RSQLite)
library(ggplot2)
library(car)
#sql connection function to ease life
datafetch <- function(table_name){
con <- dbConnect(SQLite(),'wooldridge.db')
read_table <- data.table(dbReadTable(con,table_name))
dbDisconnect(con)
return(read_table)
}
vote <- datafetch("vote1")
law <- datafetch("lawsch85")
#law1 <- law
#law1$LSAT[which(is.na(law1$LSAT))] <- 0
#law1$GPA[which(is.na(law1$GPA))] <- 0
model1 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank)
summary(model1)
install.packages("RSQLite")
#packages used for the assignment
library(data.table)
library(DBI)
library(RSQLite)
library(ggplot2)
library(car)
#sql connection function to ease life
datafetch <- function(table_name){
con <- dbConnect(SQLite(),'wooldridge.db')
read_table <- data.table(dbReadTable(con,table_name))
dbDisconnect(con)
return(read_table)
}
law <- datafetch("lawsch85")
#law1 <- law
#law1$LSAT[which(is.na(law1$LSAT))] <- 0
#law1$GPA[which(is.na(law1$GPA))] <- 0
model1 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank)
summary(model1)
linearHypothesis(model1,c("LSAT=0,GPA=0"))
linearHypothesis(model1,c("LSAT=0","GPA=0"))
model2 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank + clsize + faculty)
summary(model2)
linearHypothesis(model1,c("clsize=0","faculty=0"))
model2 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank + clsize + faculty)
summary(model2)
linearHypothesis(model1,c("clsize=0","faculty=0"))
linearHypothesis(model2,c("clsize=0","faculty=0"))
law <- datafetch("lawsch85")
law1 <- law
law1$LSAT[which(is.na(law1$LSAT))] <- 0
law1$GPA[which(is.na(law1$GPA))] <- 0
model1 <- lm(data = law1, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank)
summary(model1)
linearHypothesis(model1,c("LSAT=0","GPA=0"))
model1 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank)
summary(model1)
linearHypothesis(model1,c("LSAT=0","GPA=0"))
model2 <- lm(data = law1, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank + clsize + faculty)
summary(model2)
linearHypothesis(model2,c("clsize=0","faculty=0"))
law <- datafetch("lawsch85")
law1 <- law
law1$LSAT[which(is.na(law1$LSAT))] <- mean(law$LSAT)
law1$GPA[which(is.na(law1$GPA))] <- mean(law$GPA)
model1 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank)
summary(model1)
linearHypothesis(model1,c("LSAT=0","GPA=0"))
model2 <- lm(data = law1, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank + clsize + faculty)
summary(model2)
linearHypothesis(model2,c("clsize=0","faculty=0"))
law1$LSAT[which(is.na(law1$LSAT))] <- median(law$LSAT)
law1$GPA[which(is.na(law1$GPA))] <- median(law$GPA)
model2 <- lm(data = law1, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank + clsize + faculty)
summary(model2)
linearHypothesis(model2,c("clsize=0","faculty=0"))
law <- datafetch("lawsch85")
law1 <- law
law1$LSAT[which(is.na(law1$LSAT))] <- mean(law$LSAT)
law1$GPA[which(is.na(law1$GPA))] <- mean(law$GPA)
model1 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank)
summary(model1)
linearHypothesis(model1,c("LSAT=0","GPA=0"))
model2 <- lm(data = law1, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank + clsize + faculty)
summary(model2)
linearHypothesis(model2,c("clsize=0","faculty=0"))
#home directory definition
setwd("/home/navarurh/documents/assignments/businessanalytics-R/assgn-2/")
#packages used for the assignment
library(data.table)
library(DBI)
library(RSQLite)
library(ggplot2)
library(car)
#sql connection function to ease life
datafetch <- function(table_name){
con <- dbConnect(SQLite(),'wooldridge.db')
read_table <- data.table(dbReadTable(con,table_name))
dbDisconnect(con)
return(read_table)
}
vote <- datafetch("vote1")
model1 <- lm(data = vote, voteA ~ log(expendA) + log(expendB) + prtystrA)
summary(model1)
model2 <- lm(data = vote, voteA ~ log(expendA) + I(log(expendA) - log(expendB)) + prtystrA)
summary(model2)
law <- datafetch("lawsch85")
law1 <- law
law1$LSAT[which(is.na(law1$LSAT))] <- mean(law$LSAT)
law1$GPA[which(is.na(law1$GPA))] <- mean(law$GPA)
model1 <- lm(data = law, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank)
summary(model1)
linearHypothesis(model1,c("LSAT=0","GPA=0"))
model2 <- lm(data = law1, log(salary) ~ LSAT + GPA + log(libvol) + log(cost) + rank + clsize + faculty)
summary(model2)
linearHypothesis(model2,c("clsize=0","faculty=0"))
hprice <- datafetch("hprice1")
model1 <- lm(data = hprice, log(price) ~ sqrft + bdrms)
summary(model1)
model2 <- lm(data = hprice, log(price) ~ I(sqrft - 150*bdrms) + bdrms)
summary(model2)
0.0858+1.96*(0.02677)
0.0858-1.96*0.02677
confint(model2)
wage <- datafetch("wage2")
model1 <- lm(data = wage, log(wage) ~ educ + exper + I(tenure+exper))
summary(model1)
0.00195-1.96*0.00474
0.00195+1.96*0.00474
confint(model1)
k401 <- datafetch("401ksubs")
k401 <- k401[which(fsize == 1),]
nrow(k401)
model1 <- lm(data = k401, nettfa ~ inc + age)
summary(model1)
(0.843-1)/0.092
pt(-1.7065,df=length(k401$age)-1)
model2 <- lm(data = k401, nettfa ~ inc)
summary(model2)
cor(k401$age,k401$inc)
kiel <- datafetch("kielmc")
model1 <- lm(data = kiel, log(price) ~ log(dist))
summary(model1)
model2 <- lm(data = kiel, log(price) ~ log(dist) + log(intst) + log(area) + log(land) + rooms + baths + age)
summary(model2)
model3 <- lm(data = kiel, log(price) ~ log(dist) + log(intst) + log(area) + log(land) + rooms + baths + age + I(log(intst)^2))
summary(model3)
model4 <- lm(data = kiel, log(price) ~ log(dist) + log(intst) + log(area) + log(land) + rooms + baths + age + I(log(intst)^2) + I(log(dist)^2))
summary(model4)
wage <- datafetch("wage1")
model1 <- lm(data = wage, log(wage) ~ educ + exper + I(exper^2))
summary(model1)
100*(0.04097 - 2*0.00071*4)
100*(0.04097 - 2*0.00071*19)
0.04097/(2*0.00071)
nrow(wage[which(exper>28.85),])
121/526*100
wage <- datafetch("wage2")
model1 <- lm(data = wage, log(wage) ~ educ + exper + I(educ*exper))
summary(model1)
pt(-2.095,df=nrow(wage)-1)
model2 <- lm(data = wage, log(wage) ~ educ + exper + I(educ*(exper-10)))
summary(model2)
confint(model2)
gpa <- datafetch("gpa2")
model1 <- lm(data = gpa, sat ~ hsize + I(hsize^2))
summary(model1)
19.814/2/2.131
model2 <- lm(data = gpa, log(sat) ~ hsize + I(hsize^2))
summary(model2)
0.0196/2/0.00208
hprice <- datafetch("hprice1")
model1 <- lm(data = hprice, log(price) ~ log(lotsize) + log(sqrft) + bdrms)
summary(model1)
pred <- data.frame(lotsize = 20000, sqrft = 2500, bdrms = 4)
predict(model1,pred)
sum(exp(model1$residuals))/nrow(hprice)
1.016348*exp(5.9929)
model2 <- lm(data = hprice, price ~ lotsize + sqrft + bdrms)
summary(model2)
hprice$pred1 <- 1.016348*exp(predict(model1))
hprice$pred2 <- predict(model2)
hprice$err1 <- hprice$price - hprice$pred1
hprice$err2 <- hprice$price - hprice$pred2
mean(hprice$err1)   #0.2448
sd(hprice$err1)     #53.00776
mean(hprice$err2)   #-4.4e-14
sd(hprice$err2)     #58.79282
