#home directory definition
setwd("C:\\Users\\navar\\OneDrive\\Documents\\UTD\\assignments\\businessanalytics-R\\assgn-1")
#packages used for the assignment
library(data.table)
library(DBI)
library(RSQLite)
library(tidyverse)
library(ggplot2)
#sql connection function to ease life
datafetch <- function(table_name){
con <- SQLite() %>% dbConnect('wooldridge.db')
con %>% dbListTables
read_table <- con %>% dbReadTable(table_name) %>% data.table
con %>% dbDisconnect
return(read_table)
}
#importing dataset 10
htv <- datafetch('htv')
htv_lab <- datafetch('htv_labels')
htv_lab
summary(htv)
#10.1
range(htv$educ)
nrow(htv[which(htv$educ == 12),])/nrow(htv)*100
mean(htv$educ)
mean(htv$motheduc)
mean(htv$fatheduc)
#10.2
mod13 <- lm(data=htv, educ ~ fatheduc + motheduc)
summary(mod13)
summary(mod14)
#10.3
mod14 <- lm(data=htv, educ ~ fatheduc + motheduc + abil)
#10.4
mod15 <- lm(data=htv, educ ~ fatheduc + motheduc + abil + I(abil^2))
summary(mod15)
#10.5
nrow(htv[which(htv$abil < -3.967094),]) #15
#calculating the constant
8.240226+0.108939*mean(htv$fatheduc)+0.190126*mean(htv$motheduc) #11.91157
#plotting
plot7 <- ggplot(htv,aes(x=abil, y=educ))
plot7 <- plot7 + geom_point(shape=16,color = '#00D7F9', size = 1)
plot7 <- plot7 + geom_line(data = htv,aes(x=abil,y = 11.91157 + 0.401462*abil + 0.050599*I(abil^2)),color='#FF5757',size = 1.5)
plot7 <- plot7 + theme(panel.background = element_rect(fill = "white", colour = "black",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid',colour = "gray"),
panel.grid.minor = element_line(size = 0.25, linetype = 'solid',colour = "gray"))
plot7 <- plot7 + xlab('Ability') + ylab('Education')
